---
import { Image } from "astro:assets";
import { getCollection } from "astro:content";

import BaseLayout from "../layouts/BaseLayout.astro";
import Quote from "../components/Quote.astro";
import Tech from "../components/Tech.astro";

export const albums = await getCollection("albums");
---

<BaseLayout
    title="Photography — Tom the Bomb"
    description="Photography albums by Tom the Bomb — featuring architecture, street, landscape, nature, and macro photography from travels across Asia and beyond."
>
    <div
        id="photography-page"
        class="my-0 flex flex-col items-center gap-16 lg:mt-32"
    >
        <Quote author="Ali Novake" styles="w-4/5 lg:w-1/3 mt-10 mb-5">
            The world moves fast, changing everything around us with each new
            day. Photography is a gift that can keep us in a moment forever,
            blissfully eternal.
        </Quote>
        <h1
            class="rounded-md border-2 border-white p-4 text-6xl font-extrabold drop-shadow-md"
        >
            Albums
        </h1>
        <div
            class="grid items-center justify-center gap-14 sm:grid-cols-1 md:grid-cols-2"
        >
            {
                albums
                    .sort((a, b) => a.data.index - b.data.index)
                    .map((album) => {
                        const href = `/photography/${album.id}`;

                        return (
                            <div
                                class={`relative h-90 w-75 overflow-hidden border-2 border-white bg-black text-center font-light whitespace-nowrap text-white shadow-[10px_10px_17px_rgba(0,0,0,0.3)] transition-all duration-300 hover:bg-white hover:[&>img]:opacity-80`}
                            >
                                <Image
                                    src={album.data.cover}
                                    alt={album.data.title}
                                    widths={[550]}
                                    quality={80}
                                    class={`min-h-full min-w-full object-cover object-center opacity-90 transition-all duration-300`}
                                    loading="eager"
                                    decoding="async"
                                    data-photo-album={href}
                                />
                                <a
                                    data-astro-prefetch
                                    class="abs-center z-50 border border-white bg-black/40 p-3 text-2xl drop-shadow-2xl"
                                    href={href}
                                >
                                    <p class="effect-underline font-soft font-extralight">
                                        {album.data.title.toUpperCase()}
                                    </p>
                                    <p class="font-zh text-2xl">
                                        {album.data.short_description}
                                    </p>
                                </a>
                            </div>
                        );
                    })
            }
        </div>
        <div class="m-5 text-center text-slate-100 sm:w-full md:w-1/2 lg:w-1/4">
            Follow me on my <a
                rel="noopener noreferrer"
                target="_blank"
                href="https://instagram.com/tom_the_bomb_111"
            >
                <Tech
                    name="instagram"
                    styles="text-instagram underline hover:text-white hover:[&>svg]:text-white"
                    >Instagram</Tech
                >
            </a>
            to see more of my photography work!
        </div>
    </div>
</BaseLayout>

<script>
    import { prefetch } from "astro:prefetch";

    document.addEventListener("astro:page-load", () => {
        if (document.getElementById("photography-page") == null) {
            return;
        }

        document.querySelectorAll("[data-photo-album]")?.forEach((album) => {
            album.addEventListener("click", () => {
                const href = album.getAttribute("data-photo-album")!;
                prefetch(href);
                window.location.href = href;
            });
        });
    });
</script>
