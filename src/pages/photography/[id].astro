---
import { Image } from "astro:assets";
import { getCollection } from "astro:content";

import BaseLayout from "../../layouts/BaseLayout.astro";
import { getAlbumImages } from "../../utils";

export async function getStaticPaths() {
    const albums = await getCollection("albums");

    return Object.values(albums).map((album) => (
        {
            params: {
                id: album.id,
            },
            props: {
                album,
            },
        }
    ));
}

const { album } = Astro.props;
const images = await getAlbumImages(album.id);
---

<BaseLayout>
    <div class="flex flex-col flex-wrap gap-3 text-center">
        <h1 class="text-4xl font-extrabold drop-shadow-lg">
            {album.data.title}
        </h1>
        <p class="text-md opacity-75 font-sans">
            {album.data.description}
        </p>
        <div class="mx-auto container my-8 sm:columns-2 md:columns-3 lg:columns-4 xl:columns-5">
            {
                images.map((image) => (
                    <Image
                        src={image}
                        alt="test"
                        class={
                            `rounded-md mb-4 shadow-lg hover:scale-[102%] opacity-90
                            border border-transparent hover:border-gray-100
                            transition-all duration-300 ease-in-out`
                        }
                        format="avif"
                        quality={50}
                        loading="lazy"
                        data-album-image
                    />
                ))
            }
        </div>
    </div>
</BaseLayout>